trigger:
- master

variables:
  CI: true

pool:
  vmImage: macOS-10.13

steps:
- script: |
    brew list
    # Azure already has brew installed, and we need to
    # unlink the existing node package first before we run setup
    brew unlink node@6
    ./scripts/setup.sh
  displayName: "Run initial setup"
- script: make check
  displayName: "Run linter"
- script: |
    pipenv install
    pipenv run ./cli.py link
    pipenv run ./cli.py unlink
    pipenv run ./cli.py link
    ./scripts/sync.sh --force
  displayName: "Link dotfiles"
